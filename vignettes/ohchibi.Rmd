---
title: "ohchibi"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ohchibi}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
suppressMessages(library(ohchibi))
```


### Introduction
ohchibi is a library with functions I recurrently utilize to analyze community data, phylogenomic and pangenome matrices. There are two types of function in the ohchibi package.<br/><br/>
The functions **oh** perform a myriad of analyses and create structued suited for plotting. <br/><br/>
The functions **chibi**   take the structure output by its corresponding **oh** function and create a plot to visualize the results. <br/><br/>

### Installation
You can install the ohchibi package using the devtools library<br/><br/>
**devtools::install_github("isaisg/ohchibi")**

### Example dataset
We will utilize the syncom dataset to show the usage of the main fucntions in thois package. 
```{r}
data(syncom)
Dat
```

####Principal Coordinate Analysis (PCoA)
```{r,fig.width = 8,fig.height = 6,fig.show = "hold"}

#Define Bray Curtis as the dissimilarity
distfun <- function(x,method) vegan::vegdist(x = x, method = "bray")

#Run the oh.pco function
mpco <- oh.pco(Tab = Dat$Tab %>% t, Map = Dat$Map,
       distfun = distfun,id_var = "ID_Matrix")

#Plot the results using chibi.pco
chibi.pco(list_ohpco = mpco,
          col_val = "Tissue",size = 8,alpha = 1,size_panel_border = 2)
```


####Constrained analysis of principal coordinates (CAP)
```{r,fig.width = 8,fig.height = 6,fig.show = "hold"}

#Run the oh.cap function
mcap <- oh.cap(Tab = Dat$Tab, Map = Dat$Map,
                  formula = "Tissue + condition + Condition(Rep)",
                  distfun = distfun,perms = 9999)

#Plot the results using chibi.cap
chibi.cap(list_ohpco = mcap,comp_a = "CAP1",comp_b = "CAP2",
          col_val = "Tissue",size = 8,alpha = 1,size_panel_border = 2)
```
